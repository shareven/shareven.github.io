<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width">
  <title>IPC 连接的识别路径 | Node.js API 文档</title>
  <link rel="icon" sizes="32x32" type="image/png" href="http://static.nodejs.cn/_static/img/favicon.png"><link rel="stylesheet" href="/api/api.css">
  <script>
    document.write('<link href="http://nodejs.cn/api/net/'&#32;+&#32;(location.port?'':'//static.nodejs.cn')&#32;+&#32;'/_static/css/api.css?1576756318301" rel="stylesheet">')
  </script>
</head>
<body class="alt apidoc" id="page_api_item">
  <div id="api-section-net">
    <div id="content" class="clearfix">
  
      <div id="column1" data-id="__ID__" class="interior">
        <header>
          <h1>IPC 连接的识别路径</h1>
          <div id="gtoc">
            <ul>
              <li>v12.14.0</li>
              <li>
                <a href="../net.html#net_identifying_paths_for_ipc_connections" name="toc">返回上层文档</a>
              </li>
              <li>
                <a href="https://github.com/nodejscn/node-api-cn/edit/master/net/identifying_paths_for_ipc_connections.md" rel="nofollow" target="_blank">提交修改</a>
              </li>
              <li>
                <a href="http://nodejs.cn/search" name="toc">搜索</a>
              </li>
            </ul>
          </div>
          <hr>
        </header>

        <div id="biz_item"></div>
  
        <div id="apicontent">
          <div id="content_left"><p><a href="http://nodejs.cn/s/mw8BBV" rel="nofollow"><code>net.connect()</code></a>, <a href="http://nodejs.cn/s/RTNxdX" rel="nofollow"><code>net.createConnection()</code></a>, <a href="http://nodejs.cn/s/xGksiu" rel="nofollow"><code>server.listen()</code></a> &#x548C;
<a href="http://nodejs.cn/s/fGCDDg" rel="nofollow"><code>socket.connect()</code></a> &#x4F7F;&#x7528;&#x4E00;&#x4E2A; <code>path</code> &#x53C2;&#x6570;&#x6765;&#x8BC6;&#x522B; IPC &#x7AEF;&#x70B9;&#x3002;</p><p>&#x5728; Unix &#x4E0A;&#xFF0C;&#x672C;&#x5730;&#x57DF;&#x4E5F;&#x79F0;&#x4E3A; Unix &#x57DF;&#x3002;
&#x53C2;&#x6570; <code>path</code> &#x662F;&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;&#x8DEF;&#x5F84;&#x540D;&#x3002;
&#x5B83;&#x88AB;&#x622A;&#x65AD;&#x4E3A; <code>sizeof(sockaddr_un.sun_path) - 1</code> &#x7684;&#x957F;&#x5EA6;&#xFF0C;&#x8BE5;&#x957F;&#x5EA6;&#x56E0;&#x64CD;&#x4F5C;&#x7CFB;&#x7EDF;&#x800C;&#x5F02;&#xFF0C;&#x5728; 91 &#x81F3; 107 &#x5B57;&#x8282;&#x4E4B;&#x95F4;&#x3002;
&#x5178;&#x578B;&#x503C;&#x5728; Linux &#x4E0A;&#x4E3A; 107&#xFF0C;&#x5728; macOS &#x4E0A;&#x4E3A; 103&#x3002;
&#x8BE5;&#x8DEF;&#x5F84;&#x53D7;&#x5230;&#x4E0E;&#x521B;&#x5EFA;&#x6587;&#x4EF6;&#x76F8;&#x540C;&#x7684;&#x547D;&#x540D;&#x7EA6;&#x5B9A;&#x548C;&#x6743;&#x9650;&#x68C0;&#x67E5;&#x3002;
&#x5982;&#x679C;&#x521B;&#x5EFA; Unix &#x57DF;&#x5957;&#x63A5;&#x5B57;&#xFF08;&#x4F5C;&#x4E3A;&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;&#x8DEF;&#x5F84;&#x53EF;&#x89C1;&#xFF09;&#x5E76;&#x4E0E; Node.js &#x7684; API &#x62BD;&#x8C61;&#x4E4B;&#x4E00;&#xFF08;&#x4F8B;&#x5982; <a href="http://nodejs.cn/s/e8cikS" rel="nofollow"><code>net.createServer()</code></a>&#xFF09;&#x4E00;&#x8D77;&#x4F7F;&#x7528;&#xFF0C;&#x5219;&#x5B83;&#x5C06;&#x4F5C;&#x4E3A; <a href="http://nodejs.cn/s/zZ874N" rel="nofollow"><code>server.close()</code></a> &#x7684;&#x4E00;&#x90E8;&#x5206;&#x53D6;&#x6D88;&#x94FE;&#x63A5;&#x3002;
&#x53E6;&#x4E00;&#x65B9;&#x9762;&#xFF0C;&#x5982;&#x679C;&#x5728;&#x8FD9;&#x4E9B;&#x62BD;&#x8C61;&#x4E4B;&#x5916;&#x521B;&#x5EFA;&#x548C;&#x4F7F;&#x7528;&#x5B83;&#xFF0C;&#x5219;&#x7528;&#x6237;&#x9700;&#x8981;&#x624B;&#x52A8;&#x5220;&#x9664;&#x5B83;&#x3002;
&#x5F53;&#x8DEF;&#x5F84;&#x7531; Node.js API &#x521B;&#x5EFA;&#x4F46;&#x7A0B;&#x5E8F;&#x7A81;&#x7136;&#x5D29;&#x6E83;&#x65F6;&#xFF0C;&#x540C;&#x6837;&#x9002;&#x7528;&#x3002;
&#x7B80;&#x800C;&#x8A00;&#x4E4B;&#xFF0C;&#x4E00;&#x65E6;&#x6210;&#x529F;&#x521B;&#x5EFA;&#x7684; Unix &#x57DF;&#x5957;&#x63A5;&#x5B57;&#x5C06;&#x5728;&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;&#x4E2D;&#x53EF;&#x89C1;&#xFF0C;&#x5E76;&#x5C06;&#x6301;&#x7EED;&#x5230;&#x53D6;&#x6D88;&#x94FE;&#x63A5;&#x3002;</p><p>&#x5728; Windows &#x4E0A;&#xFF0C;&#x672C;&#x5730;&#x57DF;&#x901A;&#x8FC7;&#x547D;&#x540D;&#x7BA1;&#x9053;&#x5B9E;&#x73B0;&#x3002;&#x8DEF;&#x5F84;&#x5FC5;&#x987B;&#x662F;&#x4EE5; <code>\\?\pipe\</code> &#x6216; <code>\\.\pipe\</code> &#x4E3A;&#x5165;&#x53E3;&#x3002;&#x8DEF;&#x5F84;&#x5141;&#x8BB8;&#x4EFB;&#x4F55;&#x5B57;&#x7B26;&#xFF0C;&#x4F46;&#x540E;&#x9762;&#x7684;&#x5B57;&#x7B26;&#x53EF;&#x80FD;&#x4F1A;&#x5BF9;&#x7BA1;&#x9053;&#x540D;&#x79F0;&#x8FDB;&#x884C;&#x4E00;&#x4E9B;&#x5904;&#x7406;&#xFF0C;&#x4F8B;&#x5982;&#x89E3;&#x6790; <code>..</code> &#x5E8F;&#x5217;&#x3002;&#x5C3D;&#x7BA1;&#x5982;&#x6B64;&#xFF0C;&#x7BA1;&#x9053;&#x7A7A;&#x95F4;&#x662F;&#x5E73;&#x9762;&#x7684;&#x3002;&#x7BA1;&#x9053;&#x4E0D;&#x4F1A;&#x6301;&#x7EED;&#xFF0C;&#x5F53;&#x6700;&#x540E;&#x4E00;&#x6B21;&#x5F15;&#x7528;&#x5173;&#x95ED;&#x65F6;&#xFF0C;&#x7BA1;&#x9053;&#x5C31;&#x4F1A;&#x88AB;&#x5220;&#x9664;&#x3002;</p><p>JavaScript &#x5B57;&#x7B26;&#x4E32;&#x8F6C;&#x4E49;&#x9700;&#x8981;&#x4F7F;&#x7528;&#x53CC;&#x53CD;&#x659C;&#x6760;&#x6307;&#x5B9A;&#x8DEF;&#x5F84;&#xFF0C;&#x4F8B;&#x5982;&#xFF1A;</p><pre><code class="language-js">net.createServer().listen(
  path.join(&apos;\\\\?\\pipe&apos;, process.cwd(), &apos;myctl&apos;));
</code></pre></div>
          <div id="content_right"><p><a href="http://nodejs.cn/s/mw8BBV" rel="nofollow"><code>net.connect()</code></a>, <a href="http://nodejs.cn/s/RTNxdX" rel="nofollow"><code>net.createConnection()</code></a>, <a href="http://nodejs.cn/s/xGksiu" rel="nofollow"><code>server.listen()</code></a> and
<a href="http://nodejs.cn/s/fGCDDg" rel="nofollow"><code>socket.connect()</code></a> take a <code>path</code> parameter to identify IPC endpoints.</p><p>On Unix, the local domain is also known as the Unix domain. The path is a
filesystem pathname. It gets truncated to a length of
<code>sizeof(sockaddr_un.sun_path) - 1</code>, which varies 91 and 107 bytes depending on
the operating system. The typical values are 107 on Linux and 103 on macOS. The
path is subject to the same naming conventions and permissions checks as would
be done on file creation. If the Unix domain socket (that is visible as a file
system path) is created and used in conjunction with one of Node.js&apos; API
abstractions such as <a href="http://nodejs.cn/s/e8cikS" rel="nofollow"><code>net.createServer()</code></a>, it will be unlinked as part of
<a href="http://nodejs.cn/s/zZ874N" rel="nofollow"><code>server.close()</code></a>. On the other hand, if it is created and used outside of
these abstractions, the user will need to manually remove it. The same applies
when the path was created by a Node.js API but the program crashes abruptly.
In short, a Unix domain socket once successfully created will be visible in the
filesystem, and will persist until unlinked.</p><p>On Windows, the local domain is implemented using a named pipe. The path <em>must</em>
refer to an entry in <code>\\?\pipe\</code> or <code>\\.\pipe\</code>. Any characters are permitted,
but the latter may do some processing of pipe names, such as resolving <code>..</code>
sequences. Despite how it might look, the pipe namespace is flat. Pipes will
<em>not persist</em>. They are removed when the last reference to them is closed.
Unlike Unix domain sockets, Windows will close and remove the pipe when the
owning process exits.</p><p>JavaScript string escaping requires paths to be specified with extra backslash
escaping such as:</p><pre><code class="language-js">net.createServer().listen(
  path.join(&apos;\\\\?\\pipe&apos;, process.cwd(), &apos;myctl&apos;));
</code></pre></div>
          <div></div>
        </div>
      </div>
    </div>
  </div>
  <script>
    document.write('<script src="http://nodejs.cn/api/net/'&#32;+&#32;(location.port&#32;?&#32;''&#32;:&#32;'//static.nodejs.cn')&#32;+&#32;'/_static/js/api.js?1576756318301"><\/script>');
  </script>
</body>
</html>