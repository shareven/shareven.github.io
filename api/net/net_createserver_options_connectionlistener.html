<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width">
  <title>net.createServer([options][, connectionListener]) | Node.js API 文档</title>
  <link rel="icon" sizes="32x32" type="image/png" href="http://static.nodejs.cn/_static/img/favicon.png"><link rel="stylesheet" href="/api/api.css">
  <script>
    document.write('<link href="http://nodejs.cn/api/net/'&#32;+&#32;(location.port?'':'//static.nodejs.cn')&#32;+&#32;'/_static/css/api.css?1576756318441" rel="stylesheet">')
  </script>
</head>
<body class="alt apidoc" id="page_api_item">
  <div id="api-section-net">
    <div id="content" class="clearfix">
  
      <div id="column1" data-id="__ID__" class="interior">
        <header>
          <h1>net.createServer([options][, connectionListener])</h1>
          <div id="gtoc">
            <ul>
              <li>v12.14.0</li>
              <li>
                <a href="../net.html#net_net_createserver_options_connectionlistener" name="toc">返回上层文档</a>
              </li>
              <li>
                <a href="https://github.com/nodejscn/node-api-cn/edit/master/net/net_createserver_options_connectionlistener.md" rel="nofollow" target="_blank">提交修改</a>
              </li>
              <li>
                <a href="http://nodejs.cn/search" name="toc">搜索</a>
              </li>
            </ul>
          </div>
          <hr>
        </header>

        <div id="biz_item"></div>
  
        <div id="apicontent">
          <div id="content_left"><div class="api_metadata">
<span>&#x65B0;&#x589E;&#x4E8E;: v0.5.0</span>
</div><ul>
<li>
<p><code>options</code> <a href="http://nodejs.cn/s/jzn6Ao" target="_blank" rel="nofollow" class="type">&lt;Object&gt;</a></p>
<ul>
<li><code>allowHalfOpen</code> <a href="http://nodejs.cn/s/jFbvuT" target="_blank" rel="nofollow" class="type">&lt;boolean&gt;</a> &#x8868;&#x660E;&#x662F;&#x5426;&#x5141;&#x8BB8;&#x534A;&#x5F00;&#x7684; TCP &#x8FDE;&#x63A5;&#x3002;<strong>&#x9ED8;&#x8BA4;&#x503C;:</strong> <code>false</code>&#x3002;</li>
<li><code>pauseOnConnect</code> <a href="http://nodejs.cn/s/jFbvuT" target="_blank" rel="nofollow" class="type">&lt;boolean&gt;</a> &#x8868;&#x660E;&#x662F;&#x5426;&#x5E94;&#x5728;&#x4F20;&#x5165;&#x8FDE;&#x63A5;&#x4E0A;&#x6682;&#x505C;&#x5957;&#x63A5;&#x5B57;&#x3002;<strong>&#x9ED8;&#x8BA4;&#x503C;:</strong> <code>false</code>&#x3002;</li>
</ul>
</li>
<li><code>connectionListener</code> <a href="http://nodejs.cn/s/ceTQa6" target="_blank" rel="nofollow" class="type">&lt;Function&gt;</a> &#x81EA;&#x52A8;&#x8BBE;&#x7F6E;&#x4E3A; <a href="http://nodejs.cn/s/4qU2j9" rel="nofollow"><code>&apos;connection&apos;</code></a> &#x4E8B;&#x4EF6;&#x7684;&#x76D1;&#x542C;&#x5668;&#x3002;</li>
<li>&#x8FD4;&#x56DE;: <a href="http://nodejs.cn/s/gBYjux" target="_blank" rel="nofollow" class="type">&lt;net.Server&gt;</a></li>
</ul><p>&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x65B0;&#x7684; TCP &#x6216; <a href="http://nodejs.cn/s/rAdYjf" rel="nofollow">IPC</a> &#x670D;&#x52A1;&#x5668;&#x3002;</p><p>&#x5982;&#x679C; <code>allowHalfOpen</code> &#x88AB;&#x8BBE;&#x7F6E;&#x4E3A; <code>true</code>&#xFF0C;&#x5219;&#x5F53;&#x5957;&#x63A5;&#x5B57;&#x7684;&#x53E6;&#x4E00;&#x7AEF;&#x53D1;&#x9001; FIN &#x6570;&#x636E;&#x5305;&#x65F6;&#xFF0C;&#x670D;&#x52A1;&#x5668;&#x5C06;&#x4EC5;&#x5728; <a href="http://nodejs.cn/s/RyEJPD" rel="nofollow"><code>socket.end()</code></a> &#x88AB;&#x663E;&#x5F0F;&#x8C03;&#x7528;&#x53D1;&#x56DE; FIN &#x6570;&#x636E;&#x5305;&#xFF0C;&#x76F4;&#x5230;&#x6B64;&#x65F6;&#x8FDE;&#x63A5;&#x4E3A;&#x534A;&#x5C01;&#x95ED;&#x72B6;&#x6001;&#xFF08;&#x4E0D;&#x53EF;&#x8BFB;&#x4F46;&#x4ECD;&#x7136;&#x53EF;&#x5199;&#xFF09;&#x3002;
&#x6709;&#x5173;&#x8BE6;&#x7EC6;&#x4FE1;&#x606F;&#xFF0C;&#x53C2;&#x9605; <a href="http://nodejs.cn/s/Hxzmh3" rel="nofollow"><code>&apos;end&apos;</code></a> &#x4E8B;&#x4EF6;&#x548C; <a href="http://nodejs.cn/s/tLsNn9" rel="nofollow">RFC 1122</a>&#xFF08;&#x7B2C; 4.2.2.13 &#x8282;&#xFF09;&#x3002;</p><p>&#x5982;&#x679C; <code>pauseOnConnect</code> &#x88AB;&#x8BBE;&#x7F6E;&#x4E3A; <code>true</code>&#xFF0C;&#x5219;&#x4E0E;&#x6BCF;&#x4E2A;&#x4F20;&#x5165;&#x8FDE;&#x63A5;&#x5173;&#x8054;&#x7684;&#x5957;&#x63A5;&#x5B57;&#x4F1A;&#x88AB;&#x6682;&#x505C;&#xFF0C;&#x5E76;&#x4E14;&#x4E0D;&#x4F1A;&#x4ECE;&#x5176;&#x53E5;&#x67C4;&#x8BFB;&#x53D6;&#x4EFB;&#x4F55;&#x6570;&#x636E;&#x3002;
&#x8FD9;&#x5141;&#x8BB8;&#x5728;&#x8FDB;&#x7A0B;&#x4E4B;&#x95F4;&#x4F20;&#x9012;&#x8FDE;&#x63A5;&#xFF0C;&#x800C;&#x539F;&#x59CB;&#x8FDB;&#x7A0B;&#x4E0D;&#x4F1A;&#x8BFB;&#x53D6;&#x4EFB;&#x4F55;&#x6570;&#x636E;&#x3002;
&#x8981;&#x4ECE;&#x6682;&#x505C;&#x7684;&#x5957;&#x63A5;&#x5B57;&#x5F00;&#x59CB;&#x8BFB;&#x53D6;&#x6570;&#x636E;&#xFF0C;&#x5219;&#x8C03;&#x7528; <a href="http://nodejs.cn/s/EKm2o7" rel="nofollow"><code>socket.resume()</code></a>&#x3002;</p><p>&#x670D;&#x52A1;&#x5668;&#x53EF;&#x4EE5;&#x662F;&#x4E00;&#x4E2A; TCP &#x670D;&#x52A1;&#x5668;&#x6216; <a href="http://nodejs.cn/s/rAdYjf" rel="nofollow">IPC</a> &#x670D;&#x52A1;&#x5668;&#xFF0C;&#x8FD9;&#x53D6;&#x51B3;&#x4E8E; <a href="http://nodejs.cn/s/xGksiu" rel="nofollow"><code>listen()</code></a> &#x76D1;&#x542C;&#x4EC0;&#x4E48;&#x3002;</p><p>&#x4EE5;&#x4E0B;&#x662F;&#x4E00;&#x4E2A; TCP &#x56DE;&#x58F0;&#x670D;&#x52A1;&#x5668;&#x7684;&#x793A;&#x4F8B;&#xFF0C;&#x5728; 8124 &#x7AEF;&#x53E3;&#x4E0A;&#x76D1;&#x542C;&#x8FDE;&#x63A5;&#xFF1A;</p><pre><code class="language-js">const net = require(&apos;net&apos;);
const server = net.createServer((c) =&gt; {
  // &apos;connection&apos; &#x76D1;&#x542C;&#x5668;&#x3002;
  console.log(&apos;&#x5BA2;&#x6237;&#x7AEF;&#x5DF2;&#x8FDE;&#x63A5;&apos;);
  c.on(&apos;end&apos;, () =&gt; {
    console.log(&apos;&#x5BA2;&#x6237;&#x7AEF;&#x5DF2;&#x65AD;&#x5F00;&#x8FDE;&#x63A5;&apos;);
  });
  c.write(&apos;&#x4F60;&#x597D;\r\n&apos;);
  c.pipe(c);
});
server.on(&apos;error&apos;, (err) =&gt; {
  throw err;
});
server.listen(8124, () =&gt; {
  console.log(&apos;&#x670D;&#x52A1;&#x5668;&#x5DF2;&#x542F;&#x52A8;&apos;);
});
</code></pre><p>&#x4F7F;&#x7528; <code>telnet</code> &#x6D4B;&#x8BD5;&#xFF1A;</p><pre><code class="language-console">$ telnet localhost 8124
</code></pre><p>&#x8981;&#x60F3;&#x5728; <code>/tmp/echo.sock</code> &#x4E0A;&#x76D1;&#x542C;&#xFF0C;&#x5219;&#x6700;&#x540E;&#x4E09;&#x884C;&#x9700;&#x6539;&#x4E3A;&#xFF1A;</p><pre><code class="language-js">server.listen(&apos;/tmp/echo.sock&apos;, () =&gt; {
  console.log(&apos;&#x670D;&#x52A1;&#x5668;&#x5DF2;&#x542F;&#x52A8;&apos;);
});
</code></pre><p>&#x4F7F;&#x7528; <code>nc</code> &#x8FDE;&#x63A5;&#x5230; Unix &#x57DF;&#x5957;&#x63A5;&#x5B57;&#x670D;&#x52A1;&#x5668;&#xFF1A;</p><pre><code class="language-console">$ nc -U /tmp/echo.sock
</code></pre></div>
          <div id="content_right"><div class="api_metadata">
<span>Added in: v0.5.0</span>
</div><ul>
<li>
<p><code>options</code> <a href="http://nodejs.cn/s/jzn6Ao" target="_blank" rel="nofollow" class="type">&lt;Object&gt;</a></p>
<ul>
<li><code>allowHalfOpen</code> <a href="http://nodejs.cn/s/jFbvuT" target="_blank" rel="nofollow" class="type">&lt;boolean&gt;</a> Indicates whether half-opened TCP
connections are allowed. <strong>Default:</strong> <code>false</code>.</li>
<li><code>pauseOnConnect</code> <a href="http://nodejs.cn/s/jFbvuT" target="_blank" rel="nofollow" class="type">&lt;boolean&gt;</a> Indicates whether the socket should be
paused on incoming connections. <strong>Default:</strong> <code>false</code>.</li>
</ul>
</li>
<li><code>connectionListener</code> <a href="http://nodejs.cn/s/ceTQa6" target="_blank" rel="nofollow" class="type">&lt;Function&gt;</a> Automatically set as a listener for the
<a href="http://nodejs.cn/s/4qU2j9" rel="nofollow"><code>&apos;connection&apos;</code></a> event.</li>
<li>Returns: <a href="http://nodejs.cn/s/gBYjux" target="_blank" rel="nofollow" class="type">&lt;net.Server&gt;</a></li>
</ul><p>Creates a new TCP or <a href="http://nodejs.cn/s/rAdYjf" rel="nofollow">IPC</a> server.</p><p>If <code>allowHalfOpen</code> is set to <code>true</code>, when the other end of the socket
sends a FIN packet, the server will only send a FIN packet back when
<a href="http://nodejs.cn/s/RyEJPD" rel="nofollow"><code>socket.end()</code></a> is explicitly called, until then the connection is
half-closed (non-readable but still writable). See <a href="http://nodejs.cn/s/Hxzmh3" rel="nofollow"><code>&apos;end&apos;</code></a> event
and <a href="http://nodejs.cn/s/tLsNn9" rel="nofollow">RFC 1122</a> (section 4.2.2.13) for more information.</p><p>If <code>pauseOnConnect</code> is set to <code>true</code>, then the socket associated with each
incoming connection will be paused, and no data will be read from its handle.
This allows connections to be passed between processes without any data being
read by the original process. To begin reading data from a paused socket, call
<a href="http://nodejs.cn/s/EKm2o7" rel="nofollow"><code>socket.resume()</code></a>.</p><p>The server can be a TCP server or an <a href="http://nodejs.cn/s/rAdYjf" rel="nofollow">IPC</a> server, depending on what it
<a href="http://nodejs.cn/s/xGksiu" rel="nofollow"><code>listen()</code></a> to.</p><p>Here is an example of an TCP echo server which listens for connections
on port 8124:</p><pre><code class="language-js">const net = require(&apos;net&apos;);
const server = net.createServer((c) =&gt; {
  // &apos;connection&apos; listener.
  console.log(&apos;client connected&apos;);
  c.on(&apos;end&apos;, () =&gt; {
    console.log(&apos;client disconnected&apos;);
  });
  c.write(&apos;hello\r\n&apos;);
  c.pipe(c);
});
server.on(&apos;error&apos;, (err) =&gt; {
  throw err;
});
server.listen(8124, () =&gt; {
  console.log(&apos;server bound&apos;);
});
</code></pre><p>Test this by using <code>telnet</code>:</p><pre><code class="language-console">$ telnet localhost 8124
</code></pre><p>To listen on the socket <code>/tmp/echo.sock</code> the third line from the last would
just be changed to:</p><pre><code class="language-js">server.listen(&apos;/tmp/echo.sock&apos;, () =&gt; {
  console.log(&apos;server bound&apos;);
});
</code></pre><p>Use <code>nc</code> to connect to a Unix domain socket server:</p><pre><code class="language-console">$ nc -U /tmp/echo.sock
</code></pre></div>
          <div></div>
        </div>
      </div>
    </div>
  </div>
  <script>
    document.write('<script src="http://nodejs.cn/api/net/'&#32;+&#32;(location.port&#32;?&#32;''&#32;:&#32;'//static.nodejs.cn')&#32;+&#32;'/_static/js/api.js?1576756318441"><\/script>');
  </script>
</body>
</html>