<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width">
  <title>完全前向保密 | Node.js API 文档</title>
  <link rel="icon" sizes="32x32" type="image/png" href="http://static.nodejs.cn/_static/img/favicon.png"><link rel="stylesheet" href="/api/api.css">
  <script>
    document.write('<link href="http://nodejs.cn/api/tls/'&#32;+&#32;(location.port?'':'//static.nodejs.cn')&#32;+&#32;'/_static/css/api.css?1576756326155" rel="stylesheet">')
  </script>
</head>
<body class="alt apidoc" id="page_api_item">
  <div id="api-section-tls">
    <div id="content" class="clearfix">
  
      <div id="column1" data-id="__ID__" class="interior">
        <header>
          <h1>完全前向保密</h1>
          <div id="gtoc">
            <ul>
              <li>v12.14.0</li>
              <li>
                <a href="../tls.html#tls_perfect_forward_secrecy" name="toc">返回上层文档</a>
              </li>
              <li>
                <a href="https://github.com/nodejscn/node-api-cn/edit/master/tls/perfect_forward_secrecy.md" rel="nofollow" target="_blank">提交修改</a>
              </li>
              <li>
                <a href="http://nodejs.cn/search" name="toc">搜索</a>
              </li>
            </ul>
          </div>
          <hr>
        </header>

        <div id="biz_item"></div>
  
        <div id="apicontent">
          <div id="content_left"><p>&#x672F;&#x8BED;&#x201C;<a href="http://nodejs.cn/s/wybzZg" rel="nofollow">&#x524D;&#x5411;&#x4FDD;&#x5BC6;</a>&#x201D;&#x6216;&#x201C;&#x5B8C;&#x5168;&#x524D;&#x5411;&#x4FDD;&#x5BC6;&#x201D;&#x662F;&#x4E00;&#x79CD;&#x5BC6;&#x94A5;&#x534F;&#x5546;&#xFF08;&#x6216;&#x79F0;&#x505A;&#x5BC6;&#x94A5;&#x4EA4;&#x6362;&#xFF09;&#x65B9;&#x6CD5;&#x3002;
&#x901A;&#x8FC7;&#x8FD9;&#x79CD;&#x65B9;&#x6CD5;,&#x5BA2;&#x6237;&#x7AEF;&#x4E0E;&#x670D;&#x52A1;&#x7AEF;&#x5728;&#x5F53;&#x524D;&#x4F1A;&#x8BDD;&#x4E2D;&#xFF0C;&#x534F;&#x5546;&#x4E00;&#x4E2A;&#x4E34;&#x65F6;&#x751F;&#x6210;&#x7684;&#x5BC6;&#x94A5;&#x8FDB;&#x884C;&#x5BF9;&#x79F0;&#x52A0;&#x5BC6;&#x7684;&#x5BC6;&#x94A5;&#x4EA4;&#x6362;&#x3002;
&#x8FD9;&#x610F;&#x5473;&#x7740;&#x5373;&#x4F7F;&#x670D;&#x52A1;&#x5668;&#x7AEF;&#x79C1;&#x94A5;&#x53D1;&#x751F;&#x6CC4;&#x6F0F;&#xFF0C;&#x7A83;&#x5BC6;&#x8005;&#x4E0E;&#x653B;&#x51FB;&#x8005;&#x4E5F;&#x65E0;&#x6CD5;&#x89E3;&#x5BC6;&#x901A;&#x4FE1;&#x5185;&#x5BB9;&#xFF0C;&#x9664;&#x975E;&#x4ED6;&#x4EEC;&#x80FD;&#x5F97;&#x5230;&#x5F53;&#x524D;&#x4F1A;&#x8BDD;&#x7684;&#x4E34;&#x65F6;&#x5BC6;&#x94A5;&#x3002;</p><p>TLS/SSL &#x63E1;&#x624B;&#x65F6;&#xFF0C;&#x4F7F;&#x7528;&#x5B8C;&#x5168;&#x524D;&#x5411;&#x5373;&#x6BCF;&#x6B21;&#x4F1A;&#x8BDD;&#x90FD;&#x4F1A;&#x968F;&#x673A;&#x751F;&#x6210;&#x4E00;&#x4E2A;&#x4E34;&#x65F6;&#x5BC6;&#x94A5;&#x5BF9;&#x7528;&#x4E8E;&#x5BF9;&#x79F0;&#x52A0;&#x5BC6;&#x5BC6;&#x94A5;&#x534F;&#x5546;(&#x533A;&#x522B;&#x4E8E;&#x6BCF;&#x6B21;&#x4F1A;&#x8BDD;&#x90FD;&#x662F;&#x7528;&#x76F8;&#x540C;&#x7684;&#x5BC6;&#x94A5;)&#x3002;
&#x5B9E;&#x73B0;&#x8FD9;&#x4E2A;&#x6280;&#x672F;&#x7684;&#x5BC6;&#x94A5;&#x4EA4;&#x6362;&#x7B97;&#x6CD5;&#x79F0;&#x4E3A;&#x201C;ephemeral&#x201D;&#x3002;</p><p>&#x5F53;&#x524D;&#x6700;&#x5E38;&#x7528;&#x7684;&#x4E24;&#x79CD;&#x5B9E;&#x73B0;&#x5B8C;&#x5168;&#x524D;&#x5411;&#x4FDD;&#x5BC6;&#x7684;&#x7B97;&#x6CD5;&#xFF08;&#x6CE8;&#x610F;&#x7B97;&#x6CD5;&#x7ED3;&#x5C3E;&#x7684;&quot;E&quot;&#xFF09;&#xFF1A;</p><ul>
<li><a href="http://nodejs.cn/s/iDZV96" rel="nofollow">DHE</a> - &#x4F7F;&#x7528;&#x4E34;&#x65F6;&#x5BC6;&#x94A5;&#x7684; Diffie Hellman &#x5BC6;&#x94A5;&#x4EA4;&#x6362;&#x7B97;&#x6CD5;&#x3002;</li>
<li><a href="http://nodejs.cn/s/p9zTGn" rel="nofollow">ECDHE</a> - &#x4F7F;&#x7528;&#x4E34;&#x65F6;&#x5BC6;&#x94A5;&#x7684;&#x692D;&#x5706;&#x66F2;&#x7EBF; Diffie Hellman &#x5BC6;&#x94A5;&#x4EA4;&#x6362;&#x7B97;&#x6CD5;&#x3002;</li>
</ul><p>&#x4F7F;&#x7528;&#x4E34;&#x65F6;&#x5BC6;&#x94A5;&#x4F1A;&#x5E26;&#x6765;&#x6027;&#x80FD;&#x635F;&#x5931;&#xFF0C;&#x56E0;&#x4E3A;&#x5BC6;&#x94A5;&#x751F;&#x6210;&#x7684;&#x8FC7;&#x7A0B;&#x5341;&#x5206;&#x6D88;&#x8017; CPU &#x8BA1;&#x7B97;&#x6027;&#x80FD;&#x3002;</p><p>&#x5982;&#x9700;&#x4F7F;&#x7528;&#x5B8C;&#x5168;&#x524D;&#x5411;&#x52A0;&#x5BC6;&#xFF0C;&#x4F8B;&#x5982;&#x4F7F;&#x7528; <code>tls</code> &#x6A21;&#x5757;&#x7684; <code>DHE</code> &#x7B97;&#x6CD5;&#xFF0C;&#x4F7F;&#x7528;&#x4E4B;&#x524D;&#x9700;&#x8981;&#x751F;&#x6210;&#x4E00;&#x4E2A; Diffie-Hellman &#x53C2;&#x6570;&#x5E76;&#x5C06;&#x5176;&#x7528; <code>dhparam</code> &#x58F0;&#x660E;&#x5728; <a href="http://nodejs.cn/s/Di4SrM" rel="nofollow"><code>tls.createSecureContext()</code></a> &#x4E2D;&#x3002;
&#x5982;&#x4E0B;&#x4F8B;&#x5B50;&#x5C55;&#x793A;&#x4E86;&#x5982;&#x4F55;&#x4F7F;&#x7528; OpenSSL &#x547D;&#x4EE4;&#x751F;&#x6210;&#x53C2;&#x6570;&#xFF1A;</p><pre><code class="language-sh">openssl dhparam -outform PEM -out dhparam.pem 2048
</code></pre><p>&#x5982;&#x9700;&#x4F7F;&#x7528; <code>ECDHE</code> &#x7B97;&#x6CD5;&#xFF0C;&#x5219;&#x4E0D;&#x9700;&#x8981;&#x751F;&#x6210; Diffie-Hellman &#x53C2;&#x6570;&#xFF0C;&#x56E0;&#x4E3A;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x9ED8;&#x8BA4;&#x7684; ECDHE &#x66F2;&#x7EBF;&#x3002;
&#x5728;&#x521B;&#x5EFA; TLS Server &#x65F6;&#xFF0C;&#x53EF;&#x4F7F;&#x7528; <code>ecdhCurve</code> &#x5C5E;&#x6027;&#x58F0;&#x660E;&#x670D;&#x52A1;&#x5668;&#x652F;&#x6301;&#x7684;&#x66F2;&#x7EBF;&#x540D;&#x8BCD;&#xFF0C;&#x8BE6;&#x8BF7;&#x53C2;&#x9605; <a href="http://nodejs.cn/s/igCzp7" rel="nofollow"><code>tls.createServer()</code></a>&#x3002;</p><p>&#x5B8C;&#x5168;&#x524D;&#x5411;&#x4FDD;&#x5BC6;&#x5728; TLSv1.2 &#x4E4B;&#x524D;&#x662F;&#x53EF;&#x9009;&#x7684;&#xFF0C;&#x4F46;&#x5B83;&#x4E0D;&#x662F; TLSv1.3 &#x7684;&#x53EF;&#x9009;&#x9879;&#xFF0C;&#x56E0;&#x4E3A;&#x6240;&#x6709; TLSv1.3 &#x5BC6;&#x7801;&#x5957;&#x4EF6;&#x90FD;&#x4F7F;&#x7528; ECDHE&#x3002;</p></div>
          <div id="content_right"><p>The term &quot;<a href="http://nodejs.cn/s/wybzZg" rel="nofollow">Forward Secrecy</a>&quot; or &quot;Perfect Forward Secrecy&quot; describes a feature
of key-agreement (i.e., key-exchange) methods. That is, the server and client
keys are used to negotiate new temporary keys that are used specifically and
only for the current communication session. Practically, this means that even
if the server&apos;s private key is compromised, communication can only be decrypted
by eavesdroppers if the attacker manages to obtain the key-pair specifically
generated for the session.</p><p>Perfect Forward Secrecy is achieved by randomly generating a key pair for
key-agreement on every TLS/SSL handshake (in contrast to using the same key for
all sessions). Methods implementing this technique are called &quot;ephemeral&quot;.</p><p>Currently two methods are commonly used to achieve Perfect Forward Secrecy (note
the character &quot;E&quot; appended to the traditional abbreviations):</p><ul>
<li><a href="http://nodejs.cn/s/iDZV96" rel="nofollow">DHE</a>: An ephemeral version of the Diffie Hellman key-agreement protocol.</li>
<li><a href="http://nodejs.cn/s/p9zTGn" rel="nofollow">ECDHE</a>: An ephemeral version of the Elliptic Curve Diffie Hellman
key-agreement protocol.</li>
</ul><p>Ephemeral methods may have some performance drawbacks, because key generation
is expensive.</p><p>To use Perfect Forward Secrecy using <code>DHE</code> with the <code>tls</code> module, it is required
to generate Diffie-Hellman parameters and specify them with the <code>dhparam</code>
option to <a href="http://nodejs.cn/s/Di4SrM" rel="nofollow"><code>tls.createSecureContext()</code></a>. The following illustrates the use of
the OpenSSL command-line interface to generate such parameters:</p><pre><code class="language-sh">openssl dhparam -outform PEM -out dhparam.pem 2048
</code></pre><p>If using Perfect Forward Secrecy using <code>ECDHE</code>, Diffie-Hellman parameters are
not required and a default ECDHE curve will be used. The <code>ecdhCurve</code> property
can be used when creating a TLS Server to specify the list of names of supported
curves to use, see <a href="http://nodejs.cn/s/igCzp7" rel="nofollow"><code>tls.createServer()</code></a> for more info.</p><p>Perfect Forward Secrecy was optional up to TLSv1.2, but it is not optional for
TLSv1.3, because all TLSv1.3 cipher suites use ECDHE.</p></div>
          <div></div>
        </div>
      </div>
    </div>
  </div>
  <script>
    document.write('<script src="http://nodejs.cn/api/tls/'&#32;+&#32;(location.port&#32;?&#32;''&#32;:&#32;'//static.nodejs.cn')&#32;+&#32;'/_static/js/api.js?1576756326155"><\/script>');
  </script>
</body>
</html>